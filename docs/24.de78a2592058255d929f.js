(window.webpackJsonp=window.webpackJsonp||[]).push([[24],{rZ4n:function(t,e,s){"use strict";s.r(e),s.d(e,"PostSearchPageModule",function(){return k});var i=s("ofXK"),o=s("tyNb"),n=s("PcbD"),r=s("nYR2"),a=s("UM8G"),c=s("B8ql"),p=s("itXk"),l=s("AytR"),h=s("fXoL"),b=s("Lpyx"),g=s("ShDn"),u=s("/Ft3"),d=s("Iw+v"),_=s("y3nj"),f=s("Yud9");function v(t,e){if(1&t&&h.Hb(0,"app-post-list-item",8),2&t){const t=e.$implicit,s=h.Wb();h.cc("searchingLabels",s.labels)("post",t)("baseUrl",s.prefix+"/?p=/post/view")}}function P(t,e){1&t&&(h.Kb(0),h.Mb(1,"div",9),h.Mb(2,"div",10),h.pc(3," \ud45c\uc2dc\ud560 \uae00\uc774 \uc5c6\uc2b5\ub2c8\ub2e4. "),h.Lb(),h.Lb(),h.Jb())}function m(t,e){1&t&&h.Hb(0,"app-loading-spot",11),2&t&&h.cc("size",50)}const{urlPrefix:y}=l.a;var w=function(t){return t.keyword="keyword",t.labels="labels",t}({});const x=[{path:":type",component:(()=>{class t extends c.a{constructor(t,e,s,i,o,n){super(t),this.elementRef=t,this.router=e,this.toastService=s,this.activatedRoute=i,this.postApiService=o,this.subscriptionService=n,this.posts=[],this.loading=!1,this.labels="",this.prefix=y,this._search=""}ngOnInit(){this._subscribeScrollEnd(),this._subscribeRouteChanges()}get empty(){return 0===this.posts.length&&!this.loading}_subscribeRouteChanges(){const t=Object(p.a)([this.activatedRoute.paramMap,this.activatedRoute.queryParamMap]).subscribe(t=>{var e,s,i;this._type=(null===(e=t[0])||void 0===e?void 0:e.get("type"))||void 0,this._search=(null===(s=t[1])||void 0===s?void 0:s.get("search"))||"",this.labels=(null===(i=t[1])||void 0===i?void 0:i.get("labels"))||"",this.posts=[],this._response=void 0,this._searchOrGetPosts()});this.subscriptionService.store("_subscribeRouteChanges",t)}_searchOrGetPosts(t){switch(this._type){case w.keyword:this._searchPosts(t);break;case w.labels:this._getPostsByLabels(t)}}_searchPosts(t){if(this._search){const e=this.postApiService.searchPosts(this._search||"").pipe(Object(r.a)(()=>this.loading=!1)).subscribe({next:e=>{this._handlePostResponse(e,t)},error:()=>{this._showErrorMessage()}});this.subscriptionService.store("_searchPosts",e),this.loading=!0}else this._toHome()}_getPostsByLabels(t){if(this.labels){const e=this.postApiService.getPosts({category:this.labels,status:"live",pageToken:t}).pipe(Object(r.a)(()=>this.loading=!1)).subscribe({next:e=>{this._handlePostResponse(e,t)},error:()=>{this._showErrorMessage()}});this.subscriptionService.store("_getPostsByLabels",e),this.loading=!0}else this._toHome()}_toHome(){this.router.navigate(["/"])}_handlePostResponse(t,e){this._response=t,e?this.posts.push(...t.items):this.posts=t.items||[]}_showErrorMessage(){this.toastService.open({message:"\ud3ec\uc2a4\ud2b8 \ubaa9\ub85d\uc744 \uac00\uc838\uc624\uc9c0 \ubabb\ud588\uc2b5\ub2c8\ub2e4",type:a.b.error})}_subscribeScrollEnd(){const t=this.scrollEnd.subscribe(()=>{this._getNextPage()});this.subscriptionService.store("_subscribeScrollEnd",t)}_getNextPage(){var t;!this.loading&&(null===(t=this._response)||void 0===t?void 0:t.nextPageToken)&&this._searchPosts(this._response.nextPageToken)}}return t.\u0275fac=function(e){return new(e||t)(h.Gb(h.l),h.Gb(o.p),h.Gb(a.a),h.Gb(o.a),h.Gb(b.a),h.Gb(n.a))},t.\u0275cmp=h.Ab({type:t,selectors:[["app-post-search-page"]],features:[h.vb([n.a]),h.tb],decls:9,vars:5,consts:[[1,"scripter-top-bar"],[1,"scripter-page-container"],[3,"scrollContainer"],[3,"hideCategories"],[1,"scripter-post-list-container"],[3,"searchingLabels","post","baseUrl",4,"ngFor","ngForOf"],[4,"ngIf"],[3,"size",4,"ngIf"],[3,"searchingLabels","post","baseUrl"],[1,"scripter-empty-container"],[1,"scripter-empty-text"],[3,"size"]],template:function(t,e){1&t&&(h.Hb(0,"div",0),h.Mb(1,"div",1),h.Hb(2,"app-header",2),h.Hb(3,"app-post-list-header",3),h.Mb(4,"div",4),h.nc(5,v,1,3,"app-post-list-item",5),h.nc(6,P,4,0,"ng-container",6),h.nc(7,m,1,1,"app-loading-spot",7),h.Lb(),h.Lb(),h.Hb(8,"app-footer")),2&t&&(h.wb(2),h.cc("scrollContainer",e.elementRef),h.wb(1),h.cc("hideCategories",!0),h.wb(2),h.cc("ngForOf",e.posts),h.wb(1),h.cc("ngIf",e.empty),h.wb(1),h.cc("ngIf",e.loading))},directives:[g.a,u.a,i.j,i.k,d.a,_.a,f.a],styles:["","[_nghost-%COMP%]{width:100%;height:100%;display:flex;align-items:stretch;flex-direction:column;flex-wrap:nowrap;position:absolute;overflow:auto}[_nghost-%COMP%] > *[_ngcontent-%COMP%]{flex:0 0 auto}[_nghost-%COMP%]   .scripter-page-container[_ngcontent-%COMP%]{flex-grow:1;flex-shrink:1;flex-basis:0}.scripter-post-list-container[_ngcontent-%COMP%], app-post-list-header[_ngcontent-%COMP%]{margin-top:50px}app-post-list-item[_ngcontent-%COMP%] + app-post-list-item[_ngcontent-%COMP%]{margin-top:55px}app-loading-spot[_ngcontent-%COMP%]{height:100px}app-footer[_ngcontent-%COMP%]{margin-top:200px}.scripter-empty-container[_ngcontent-%COMP%]{display:flex;align-items:center;justify-content:center;flex-wrap:wrap;height:100px}.scripter-empty-container[_ngcontent-%COMP%] > *[_ngcontent-%COMP%]{flex:0 0 auto}.scripter-empty-text[_ngcontent-%COMP%]{text-align:center;font-size:14px;color:#bebebe}"]}),t})()}];let M=(()=>{class t{}return t.\u0275mod=h.Eb({type:t}),t.\u0275inj=h.Db({factory:function(e){return new(e||t)},imports:[[o.r.forChild(x)],o.r]}),t})();var C=s("YwCB"),O=s("DcXL"),S=s("eX/7"),L=s("B6jC"),R=s("24OP");let k=(()=>{class t{}return t.\u0275mod=h.Eb({type:t}),t.\u0275inj=h.Db({factory:function(e){return new(e||t)},imports:[[i.c,M,C.a,O.a,S.a,L.a,R.a]]}),t})()}}]);